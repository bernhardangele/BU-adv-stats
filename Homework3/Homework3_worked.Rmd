---
title: "Homework 3"
author: "Your name here"
date: "Your date here"
output: word_document
---

# Assignment

Here is another data set stolen from Andy Johnson. This one is about the relationship between alcohol and driving performance. Participants received either a drink with actual alcohol, a placebo drink that they thought contained alcohol, but actually didn't, or no drink at all.
Run the ANOVA and perform the appropriate assumption checks. Report the results as shown in the file `Homework3_template.Rmd`.
I've already started you off with opening the file below and adding a subject column -- you just have to make sure the working directory is correct.

```{r, echo = FALSE}
# echo = FALSE 
# don't forget to replace the \ backslashes with forward slashes / if you're on Windows
library(ez)
library(knitr)

setwd("C:/Bernhard/Documents/Teaching/Winter 2014/Advanced Statistics/BU-adv-stats/Homework3")

drive <- read.csv("Alcohol and driving performance.csv")

# add a subject column for ezANOVA
# very simple: each observation is a different person
# "subject" is a discrete variable, so make it a factor()
drive$subject <- factor(1:nrow(drive))

drive_stats <- ezStats(data = drive, 
                       dv = Driving.Score, 
                       wid = subject, 
                       between =  Alcohol.Condition)

```


In order to evaluate the effect of apparent alcohol content on driving skill, we performed a one-way between-subjects ANOVA with driving skill as the dependent variable and apparent alcohol content (alcohol vs. alcohol placebo vs. no drink control) as the independent variable. Table 1 and Figure 1 show the condition means.

*Table 1. Means, sample sizes (N), standard deviations (SD), and standard errors (SE) for the swear word usage conditions.*
```{r, results='asis', echo=FALSE}
# need results = "asis" so that the table is drawn properly
# get rid of the last column of drive_stats (you don't need Fisher's LSD in a results section)
drive_stats <- drive_stats[,1:4]
# Rename the first column to make the table look more professional
colnames(drive_stats)[1] <- "Condition"
# instead, add a standard error column
drive_stats$SE <- drive_stats$SD/sqrt(drive_stats$N)
# make a nice-looking table  
kable(drive_stats)
```

*Figure 1. Condition means. Error bars denote 95% confidence intervals.*

```{r, echo=FALSE}
# We could use ezPlot to make the figure, but we'd rather have a barplot
# use ggplot2 to plot drive_stats
library(ggplot2)
# calculate upper and lower bounds of 95% CIs around the condition means for error bars
drive_stats$upper <- drive_stats$Mean + 1.96 * drive_stats$SE
drive_stats$lower <- drive_stats$Mean - 1.96 * drive_stats$SE

drive_plot <- qplot(data =  drive_stats, x = Condition, y = Mean, fill = Condition, geom = "bar", stat = "identity", ymax = upper, ymin = lower)
# geom = "bar": draw a barplot
# stat = "identity": don't aggregate the data (they are already aggregated by ezStats)
# fill = colours of the bars
# ymin and ymax: lower and upper limits of the error bars

drive_plot + 
  geom_errorbar(width = .25)+ # add error bars
  ylab("Mean time until hand withdrawal in seconds") # change y axis label to something more informative

```

```{r, echo=FALSE}
# perform the actual ANOVA so we can use the results when writing our report
drive_anova <- ezANOVA(data = drive, 
                      dv = Driving.Score,
                      wid = subject, 
                      between = Alcohol.Condition, 
                      return_aov = TRUE)

# get the residuals for normality check
drive_anova_resid <- resid(drive_anova$aov)

# Perform the Shapiro-Wilk test
drive_anova_shapiro <- shapiro.test(drive_anova_resid)

# do pairwise t-tests
drive_anova_pairwise <- pairwise.t.test(x = drive$Driving.Score, g = drive$Alcohol.Condition, pool.sd = TRUE)

# here's a little helper function to get the p-values printed right
print_p <- function(p){
  if(p < .01) return("*p* < .01")
  if(p <= .05) return(paste("*p* =", p))
  if(p > .05) return("*p* > .05")
}
```

The ANOVA showed that overall, there was a significant effect of the apparent alcohol condition, *F*(`r drive_anova$ANOVA$DFn`, `r drive_anova$ANOVA$DFd`) = `r drive_anova$ANOVA$F`, $\eta^2$ = `r drive_anova$ANOVA$ges`, `r print_p(drive_anova$ANOVA$p)`. There was no evidence for unequality of variances from Levene's test (`r print_p(drive_anova$"Levene's Test for Homogeneity of Variance"$p)`). Also, the Shapiro-Wilk test revealed no deviations from normality in the residuals (`r print_p(drive_anova_shapiro$p.value)`).

Post-hoc comparisons performed using Holm-Bonferroni corrected *t*-tests showed that the alcohol placebo condition (mean time until hand withdrawal: `r drive_stats[drive_stats$Condition == "Placebo",]$Mean`) and the alcohol condition (mean: `r drive_stats[drive_stats$Condition == "Alcohol",]$Mean`) were significantly different from the no drink control condition (mean: `r drive_stats[drive_stats$Condition == "No drink control",]$Mean`; placebo vs. no drink control: `r print_p(drive_anova_pairwise$p.value["No drink control", "Alcohol Placebo"])`; no drink control vs. alcohol: `r print_p(drive_anova_pairwise$p.value["No drink control", "Alcohol"])`), but the alcohol placebo condition did not differ significantly from the alcohol condition (`r print_p(drive_anova_pairwise$p.value["Alcohol Placebo","Alcohol"])`).

### Summary

Based on the results of our analyses, we can conclude that repeating swear words seemed to increase participants' drive tolerance compared to repeating neutral words or remaining quiet. Repeating neutral words did not seem to increase participants' drive tolerance compared to remaining quiet. It seems that using swear words in driveful situations may be an effective strategy.